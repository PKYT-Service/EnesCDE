<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Performance</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .results { margin-top: 20px; }
        .mode-select { margin-bottom: 20px; }
    </style>
</head>
<body>
    <h1>Test de Performance</h1>
    <div class="mode-select">
        <label for="mode">Choisissez le mode de test :</label>
        <select id="mode">
            <option value="simple">Simple</option>
            <option value="basique">Basique</option>
            <option value="moyen">Moyen</option>
            <option value="puissance" selected>Puissance</option>
            <option value="extremement">Extrêmement</option>
        </select>
        <button onclick="startTests()">Lancer les tests</button>
    </div>
    <div class="results" id="results"></div>

    <script>
        const modes = {
            simple: { iterations: 1000, weight: 0.5 },
            basique: { iterations: 5000, weight: 1 },
            moyen: { iterations: 10000, weight: 1.5 },
            puissance: { iterations: 50000, weight: 2 },
            extremement: { iterations: 100000, weight: 2.5 }
        };

        async function startTests() {
            const mode = document.getElementById('mode').value;
            const { iterations, weight } = modes[mode];

            let resultsHTML = '<h2>Résultats</h2>';
            document.getElementById('results').innerHTML = resultsHTML;

            for (let i = 1; i <= 5; i++) {
                const cpuTime = testCPU(iterations);
                const gpuTime = testGPU(iterations);
                const ramTime = testRAM(iterations);

                const totalTime = cpuTime + gpuTime + ramTime;
                const totalPercentage = (totalTime / (3 * iterations * weight)) * 100;

                resultsHTML += `
                    <h3>Test ${i}</h3>
                    <p>CPU: ${cpuTime.toFixed(2)} ms (${((cpuTime / iterations) * 100).toFixed(2)}%)</p>
                    <p>GPU: ${gpuTime.toFixed(2)} ms (${((gpuTime / iterations) * 100).toFixed(2)}%)</p>
                    <p>RAM: ${ramTime.toFixed(2)} ms (${((ramTime / iterations) * 100).toFixed(2)}%)</p>
                    <h4>Total: ${totalTime.toFixed(2)} ms (${totalPercentage.toFixed(2)}%)</h4>
                `;

                document.getElementById('results').innerHTML = resultsHTML;

                await new Promise(resolve => setTimeout(resolve, 4000));  // Wait for 4 seconds
            }
        }

        function testCPU(iterations) {
            const start = performance.now();
            let sum = 0;
            for (let i = 0; i < iterations; i++) {
                sum += Math.sqrt(i) * Math.log(i + 1);
            }
            const end = performance.now();
            return end - start;
        }

        function testGPU(iterations) {
            const start = performance.now();
            const canvas = document.createElement('canvas');
            const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            if (!gl) return 0;
            for (let i = 0; i < iterations; i++) {
                gl.clear(gl.COLOR_BUFFER_BIT);
            }
            const end = performance.now();
            return end - start;
        }

        function testRAM(iterations) {
            const start = performance.now();
            const array = new Array(iterations).fill(0);
            for (let i = 0; i < iterations; i++) {
                array[i] = Math.random();
            }
            const end = performance.now();
            return end - start;
        }
    </script>
</body>
</html>
